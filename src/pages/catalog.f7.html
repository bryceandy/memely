<template>
  <div class="page" data-name="catalog">
    <div class="navbar">
      <div class="navbar-bg"></div>
      <div class="navbar-inner sliding">
        <div class="title">Catalog</div>
      </div>
    </div>
    <div class="page-content">
      <div id="gifs"></div>
    </div>
  </div>
</template>
<script>

  export default {
      on: {
          pageInit () {
              const myApp = this.$app, $$ = this.$$;

              // See trending gifs
              myApp.request({
                  url: 'https://api.giphy.com/v1/gifs/trending?api_key='+myApp.data.giphyApiKey,
                  method: 'GET',
                  dataType: 'json',
                  success(data, status, xhr) {
                      data.data.forEach(function (gif) {
                          $$('#gifs').append(`<img src="`+gif.images.downsized_large.url+`" alt="`+gif.id+`" height="`+gif.images.downsized_large.height+`" width="`+gif.images.downsized_large.width+`"/>`)
                      })
                  },
                  error(xhr, status) {
                      myApp.toast.create({
                          text: 'Failed to load gifs '+status,
                          closeButton: true,
                          closeButtonText: 'OK',
                          closeButtonColor: 'red',
                          closeTimeout: 4000,
                      }).open()
                  }
              })
          }
      }
  };
</script>
