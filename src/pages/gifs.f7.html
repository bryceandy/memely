<template>
  <div class="page" data-name="gifs">
    <!-- Top Navbar -->
    <div class="navbar navbar-large">
      <div class="navbar-bg"></div>
      <div class="navbar-inner">
        <div class="right">
          {{> "menu-link"}}
        </div>
        <div class="title sliding">
          <img src="static/memely.svg" alt="logo" class="title-logo">
        </div>
        <div class="title-large">
          <div class="title-large-text">
            <img src="static/memely.svg" alt="logo" class="title-logo title-logo-large">
          </div>
        </div>
      </div>
    </div>

    <!-- Scrollable page content-->
    <div class="page-content gifs-page-content">
      <div id="gifs" class="block"></div>
    </div>
  </div>
</template>
<script>
    export default {
        on: {
            pageInit () {
                const myApp = this.$app, $$ = this.$$;

                // See trending gifs
                myApp.request({
                    url: 'https://api.giphy.com/v1/gifs/trending?api_key='+myApp.data.giphyApiKey,
                    method: 'GET',
                    dataType: 'json',
                    success(data, status, xhr) {
                        data.data.forEach(function (gif) {
                            $$('#gifs').append(`<img src="`+gif.images.downsized_large.url+`" alt="`+gif.id+`" height="`+gif.images.downsized_large.height+`" width="`+gif.images.downsized_large.width+`"/>`)
                        })
                    },
                    error(xhr, status) {
                        myApp.toast.create({
                            text: 'Failed to load gifs '+status,
                            closeButton: true,
                            closeButtonText: 'OK',
                            closeButtonColor: 'red',
                            closeTimeout: 4000,
                        }).open()
                    }
                })
            }
        }
    }
</script>
